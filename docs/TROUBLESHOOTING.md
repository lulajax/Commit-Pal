# 故障排查指南

## Git 命令无法在选中的项目中运行

如果你在使用 AI 对话助手或其他功能时遇到 "Git 命令无法运行" 的问题，请按照以下步骤排查：

### 1. 确认项目是有效的 Git 仓库

**检查步骤：**
1. 在左侧项目列表中选择你的项目
2. 打开 **AI 对话** 标签页
3. 输入："查看暂存区状态"

**正常情况下会显示：**
```
✅ 项目：你的项目名
📊 暂存区变更：...
```

**如果出现错误：**

#### 错误 1：项目路径不存在
```
❌ 错误：项目路径不存在：X:\path\to\project
```

**解决方法：**
- 项目可能已被移动或删除
- 在左侧项目列表中删除该项目
- 重新添加正确的项目路径

#### 错误 2：不是有效的 Git 仓库
```
❌ 读取 Git 仓库失败：...
```

**解决方法：**
1. 确认项目文件夹包含 `.git` 目录
2. 在命令行中进入项目目录，运行：
   ```bash
   git status
   ```
3. 如果提示 "not a git repository"，需要初始化：
   ```bash
   git init
   ```

### 2. 确认已选择项目

**检查方法：**
- 查看对话窗口顶部的状态标签
- 应该显示：`当前项目: 项目名`
- 如果显示 `未选择项目`，请在左侧列表中点击选择一个项目

### 3. 确认项目路径权限

**Windows 系统：**
1. 右键点击项目文件夹
2. 选择 "属性" > "安全"
3. 确保当前用户有 "读取" 和 "修改" 权限

**Linux/macOS 系统：**
```bash
ls -la /path/to/project
# 确保你有读写权限
```

### 4. 常见错误信息解读

#### ⚠️ 当前暂存区没有任何变更

**含义：** Git 仓库正常，但暂存区是空的

**解决方法：**
```bash
# 查看工作区状态
git status

# 添加文件到暂存区
git add .

# 或添加特定文件
git add <文件名>
```

#### ❌ Git 操作失败：仓库损坏或不完整

**可能原因：**
- `.git` 目录损坏
- Git 操作被中断

**解决方法：**
1. 备份项目代码
2. 尝试修复：
   ```bash
   git fsck
   ```
3. 如果无法修复，重新克隆仓库或初始化

### 5. 调试模式

**查看详细错误信息：**
1. 在 AI 对话中询问具体的错误
2. 查看应用控制台输出
3. 检查项目路径是否包含特殊字符或空格

### 6. 项目路径要求

✅ **正确的路径格式：**
- Windows: `C:\Users\Username\project`
- Linux/macOS: `/home/username/project`

❌ **避免的路径：**
- 包含中文字符（可能导致编码问题）
- 包含特殊符号 `@#$%` 等
- 网络驱动器（性能较差）
- 云同步文件夹（可能导致冲突）

### 7. 测试 Git 功能

**完整测试流程：**

1. **测试暂存区查看：**
   ```
   你：查看暂存区状态
   助手：[显示暂存区内容或提示为空]
   ```

2. **测试提交历史：**
   ```
   你：最近的提交记录
   助手：[显示最近5条提交]
   ```

3. **测试生成 commit：**
   ```
   你：帮我生成一个 commit
   助手：[分析暂存区变更]
   ```

4. **测试提交报告：**
   ```
   你：生成本周的提交报告
   助手：[显示本周提交记录]
   ```

### 8. 获取帮助

如果以上方法都无法解决问题：

1. **查看完整错误信息：**
   - AI 助手会显示详细的错误信息和项目路径
   - 截图保存错误信息

2. **手动测试 Git：**
   ```bash
   cd /path/to/project
   git status
   git log --oneline -5
   git diff --cached
   ```

3. **检查 Java 控制台：**
   - 运行应用时查看控制台输出
   - 寻找 `IOException` 或 `GitAPIException`

4. **提交 Issue：**
   - 访问项目 GitHub 页面
   - 创建新的 Issue
   - 包含：操作系统、错误信息、项目路径示例

### 9. 性能优化建议

**如果 Git 操作很慢：**

1. **减少仓库大小：**
   ```bash
   # 清理不需要的历史
   git gc --aggressive
   ```

2. **使用本地硬盘：**
   - 避免网络驱动器
   - 避免云同步文件夹

3. **关闭杀毒软件扫描：**
   - 将项目文件夹添加到杀毒软件白名单

### 10. 最佳实践

✅ **推荐做法：**
- 使用英文路径和项目名
- 定期提交和推送代码
- 保持 `.git` 目录完整
- 使用标准的 Git 工作流

❌ **避免：**
- 手动修改 `.git` 目录
- 在多个应用中同时操作同一仓库
- 使用不支持的 Git 版本（推荐 2.0+）

---

## 其他常见问题

### 应用启动失败

**错误：ClassCastException**
- 检查是否已更新到最新版本
- 清理 Maven 缓存：`mvn clean`
- 重新编译：`mvn clean javafx:run`

### LLM API 调用失败

**检查：**
1. API Key 是否正确
2. Base URL 是否正确
3. 网络连接是否正常
4. 代理设置是否正确（如需要）

### 对话助手无响应

**可能原因：**
- LLM 设置未配置
- 网络超时
- API 限流

**解决方法：**
- 检查右侧面板的 LLM 设置
- 点击"清空对话"重试
- 切换到其他标签页再切回来

---

**还有问题？** 欢迎在 GitHub 上提交 Issue！

